// PostgreSQL schema for MJ CHAUFFAGE e-commerce platform
// Production-ready schema with Neon PostgreSQL compatibility

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// User Management
model User {
  id           String   @id @default(uuid())
  email        String   @unique
  firstName    String   @map("first_name")
  lastName     String   @map("last_name")
  password     String?
  phone        String?
  avatar       String?
  role         String   @default("CUSTOMER") // Using String instead of enum
  isActive     Boolean  @default(true) @map("is_active")
  isVerified   Boolean  @default(false) @map("is_verified")
  emailVerified DateTime? @map("email_verified")
  lastLoginAt  DateTime? @map("last_login_at")

  // OAuth fields
  googleId     String?  @unique @map("google_id")

  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  // Relationships
  customer     Customer?
  technician   Technician?
  sessions     UserSession[]
  passwordResets PasswordReset[]

  // Analytics relationships (for tracking and E2E tests)
  pageAnalytics    PageAnalytics[]
  ecommerceEvents  EcommerceEvent[]
  errorLogs        ErrorLog[]
  analyticsSessions AnalyticsSession[]

  @@map("users")
}